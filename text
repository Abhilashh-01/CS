import requests, csv, subprocess

# source: Abuse CH
response = requests.get(
    "https://feodotracker.abuse.ch/downloads/ipblocklist.csv"
).text

rule = 'netsh advfirewall firewall delete rule name="BadIP"'
subprocess.run(["PowerShell", "-Command", rule])

mycsv = csv.reader(
    filter(lambda x: not x.startswith("#"), response.splitlines())
)

for row in mycsv:
    ip = row[1]
    if ip != "dst_ip":
        print("Added Rule to block:", ip)
        rule = "netsh advfirewall firewall add rule name='BadIP' Dir=Out Action=Block RemoteIP=" + ip
        subprocess.run(["PowerShell", "-Command", rule])
        rule = "netsh advfirewall firewall add rule name='BadIP' Dir=Out Action=Block RemoteIP=" + ip         
        subprocess.run(["PowerShell", "-Command", rule])


import re
def check_password(password):
    if len(password) < 8:
        return "weak"
    if not re.search(r"\d",password):
        return "weak"
    if not re.search(r"[A-Z]",password):
        return "weak"
    if not re.search(r"[a-z]",password):
        return "weak"
    if not re.search(r"[!@#$%^&*()]",password):
        return "Medium"
    return "Strong"
pwd = input("Enter Password: ")
print(check_password(pwd))
